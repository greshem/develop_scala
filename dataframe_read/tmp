root
 |-- date: string (nullable = true)
 |-- city: string (nullable = true)
 |-- minTem: integer (nullable = false)
 |-- maxTem: integer (nullable = false)

Count: 10500
First row: [2016-03-15,北京,2,14]
+----------+----+------+------+
|      date|city|minTem|maxTem|
+----------+----+------+------+
|2016-03-15|  北京|     2|    14|
|2016-03-16|  北京|     6|    17|
|2016-03-17|  北京|     6|    18|
|2016-03-18|  北京|     7|    20|
|2016-03-19|  北京|     5|    16|
|2016-03-20|  北京|     4|    16|
|2016-03-21|  北京|     6|    17|
|2016-03-15|  海淀|     2|    14|
|2016-03-16|  海淀|     6|    17|
|2016-03-17|  海淀|     6|    18|
|2016-03-18|  海淀|     7|    20|
|2016-03-19|  海淀|     5|    16|
|2016-03-20|  海淀|     4|    16|
|2016-03-21|  海淀|     6|    17|
|2016-03-15|  朝阳|     2|    14|
|2016-03-16|  朝阳|     6|    17|
|2016-03-17|  朝阳|     6|    18|
|2016-03-18|  朝阳|     7|    20|
|2016-03-19|  朝阳|     5|    16|
|2016-03-20|  朝阳|     4|    16|
+----------+----+------+------+
only showing top 20 rows

Filter city beijing
+----+----+------+------+
|date|city|minTem|maxTem|
+----+----+------+------+
+----+----+------+------+

+----------+----+------+------+
|      date|city|minTem|maxTem|
+----------+----+------+------+
|2016-03-15|  北京|     2|    14|
|2016-03-16|  北京|     6|    17|
|2016-03-17|  北京|     6|    18|
|2016-03-18|  北京|     7|    20|
|2016-03-19|  北京|     5|    16|
|2016-03-20|  北京|     4|    16|
|2016-03-21|  北京|     6|    17|
+----------+----+------+------+

Group by city
+----+-----+
|city|count|
+----+-----+
|  海伦|    7|
|加格达奇|    7|
|  平山|    7|
|  柏乡|    7|
|  贡嘎|    7|
|  鹤峰|    7|
|  肇源|    7|
|  宝清|    7|
|  曲阳|    7|
|  常州|    7|
|  恩施|    7|
|  即墨|    7|
| 吉木乃|    7|
|墨竹工卡|    7|
|  东丽|    7|
|  大庆|    7|
|  珲春|    7|
|  高平|    7|
|  三原|    7|
|  榆林|    7|
+----+-----+
only showing top 20 rows

Group by city, avg minTem
+----+-------------------+
|city|        avg(minTem)|
+----+-------------------+
|  海伦| -7.142857142857143|
|加格达奇|-12.285714285714286|
|  平山|  5.571428571428571|
|  柏乡|  4.428571428571429|
|  贡嘎|                0.0|
|  鹤峰|  9.428571428571429|
|  肇源|-1.5714285714285714|
|  宝清| -6.142857142857143|
|  曲阳| 3.5714285714285716|
|  常州|  7.857142857142857|
|  恩施| 10.142857142857142|
|  即墨| 3.7142857142857144|
| 吉木乃|-2.4285714285714284|
|墨竹工卡|-0.8571428571428571|
|  东丽|  6.714285714285714|
|  大庆|-1.1428571428571428|
|  珲春|                0.0|
|  高平|  3.142857142857143|
|  三原|  7.857142857142857|
|  榆林|                3.0|
+----+-------------------+
only showing top 20 rows

Group by city, avg minTem throw sql
+----+-------------------+
|city|                _c1|
+----+-------------------+
|  海伦| -7.142857142857143|
|加格达奇|-12.285714285714286|
|  平山|  5.571428571428571|
|  柏乡|  4.428571428571429|
|  贡嘎|                0.0|
|  鹤峰|  9.428571428571429|
|  肇源|-1.5714285714285714|
|  宝清| -6.142857142857143|
|  曲阳| 3.5714285714285716|
|  常州|  7.857142857142857|
|  恩施| 10.142857142857142|
|  即墨| 3.7142857142857144|
| 吉木乃|-2.4285714285714284|
|墨竹工卡|-0.8571428571428571|
|  东丽|  6.714285714285714|
|  大庆|-1.1428571428571428|
|  珲春|                0.0|
|  高平|  3.142857142857143|
|  三原|  7.857142857142857|
|  榆林|                3.0|
+----+-------------------+
only showing top 20 rows

Write to: /tmp/bbbb//json
/tmp/test_191
